"use strict";var _commander=_interopRequireDefault(require("commander")),_backup=_interopRequireDefault(require("./backup")),_restore=_interopRequireDefault(require("./restore")),_getWorkingDirectory=_interopRequireDefault(require("./lib/getWorkingDirectory")),_fs=require("fs"),_path=_interopRequireDefault(require("path"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function asyncGeneratorStep(e,r,t,n,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void t(e)}c.done?r(u):Promise.resolve(u).then(n,a)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(r,t){var n=c.apply(e,i);function a(e){asyncGeneratorStep(n,r,t,a,o,"next",e)}function o(e){asyncGeneratorStep(n,r,t,a,o,"throw",e)}a(void 0)})}}var defaultFileName=".metadata.json";_commander.default.version("0.1.0","-v, --version"),_commander.default.command("restore [directory]").description("restore metadata to files").option("-r, --recursive","recursive").option("-f, --filename <fileName>","optionally supply the filename where the metadata is stored").action(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_getWorkingDirectory.default)(r);case 2:if(n=e.sent)return a=t.fileName||defaultFileName,e.prev=5,e.next=8,_fs.promises.stat(_path.default.join(n,a));e.next=24;break;case 8:if(e.sent.isFile())return e.next=12,(0,_restore.default)(n,a,t.recursive);e.next=14;break;case 12:e.next=16;break;case 14:console.error("".concat(a," is not a file")),process.exit(1);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),console.error("".concat(a," not found")),process.exit(1);case 22:e.next=25;break;case 24:process.exit(1);case 25:case"end":return e.stop()}},e,this,[[5,18]])}));return function(e,r){return t.apply(this,arguments)}}()),_commander.default.command("backup [directory]").description("backup metadata").option("-r, --recursive","recursive").option("-f, --filename <fileName>","optionally supply the filename where the metadata is stored").action(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function e(r,t){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_getWorkingDirectory.default)(r);case 2:if(n=e.sent)return a=t.fileName||defaultFileName,e.next=7,(0,_backup.default)(n,a,t.recursive);e.next=9;break;case 7:e.next=10;break;case 9:process.exit(1);case 10:case"end":return e.stop()}},e,this)}));return function(e,r){return t.apply(this,arguments)}}()),_commander.default.command("*").action(function(e){_commander.default.outputHelp(),process.exit(1)}),_commander.default.parse(process.argv);